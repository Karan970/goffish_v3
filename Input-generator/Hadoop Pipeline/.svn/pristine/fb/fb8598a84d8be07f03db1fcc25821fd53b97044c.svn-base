package in.dream_lab.hadoopPipeline.cc;

import java.io.IOException;

import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;


public class VornoiSliceMapper extends Mapper<Object,Text,IntWritable,Text> {
	

	@Override
	protected void map(Object key, Text value,Context context)
			throws IOException, InterruptedException {
		// TODO Parse the input data in the form  <Vid,SGid,Pid>  <Eid,SinkID,SubgraphID,Pid:Eid,SinkID,SubgraphID,Pid:....>
		
		String[] inputLine = value.toString().split("\\s+");
	
		String srcTuple=inputLine[0];
		int srcPid = Integer.parseInt(srcTuple.split(",")[2]);
		long srcSGid =Long.parseLong(srcTuple.split(",")[1]);
		long srcid =Long.parseLong(srcTuple.split(",")[0]);
		
		StringBuilder sb=new StringBuilder();
		
		sb.append(srcid).append(",").append(srcSGid).append("#").append(inputLine[1]);
		
		
		
		
//		String PidSGid = inputLine[0];
//		String VidAdjList = inputLine[1];
//		
//		int Pid = Integer.parseInt(PidSGid.split("#")[0]);
//		long SGid =Long.parseLong(PidSGid.split("#")[1]);
//		//System.out.println("MAPPER "+Pid + "  "  +SGid+"#"+VidAdjList);
	
		context.write(new IntWritable(srcPid), new Text( sb.toString()));
		
	}

}
